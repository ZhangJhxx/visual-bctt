(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49510240"],{"619d":function(e,t,o){"use strict";o.d(t,"c",(function(){return m})),o.d(t,"e",(function(){return f})),o.d(t,"b",(function(){return h})),o.d(t,"d",(function(){return p})),o.d(t,"a",(function(){return b}));var r=o("bc3a"),n=o.n(r),s=o("5c96"),a=o("4360"),i=o("5f87"),c=o("a78e"),l=o.n(c),u=n.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"/visual-bctt/"}).VUE_APP_SSBC1_API,timeout:5e3});u.interceptors.request.use((function(e){return a["a"].getters.token&&(e.headers["X-Token"]=Object(i["a"])(),e.baseURL=l.a.get("SourceChain")),e}),(function(e){return console.log(e),Promise.reject(e)})),u.interceptors.response.use((function(e){var t=e.data;return 2e4!==t.code?(Object(s["Message"])({message:t.message||"Error",type:"error",duration:5e3}),50008!==t.code&&50012!==t.code&&50014!==t.code||s["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){a["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):t}),(function(e){return console.log("err"+e),Object(s["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}));var d=u;function m(e){return d({url:"/postTran",method:"post",data:e})}function f(){return d({url:"/registerAccount",method:"get"})}function h(e){return d({url:"/postContract",method:"post",data:e})}function p(e){return d({url:"/query",method:"post",data:e})}function b(){return d({url:"/genCode",method:"get"})}},fd0a:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-row",{attrs:{gutter:0}},[o("el-col",{attrs:{span:22,offset:1,xs:24}},[o("el-form",{attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[o("el-form-item",{attrs:{label:"发起地址"}},[o("el-select",{staticClass:"filter-item",staticStyle:{width:"100%"},model:{value:e.form.from,callback:function(t){e.$set(e.form,"from",t)},expression:"form.from"}},e._l(e.userList,(function(t){return o("el-option",{key:t.address,attrs:{label:t.address,value:t.address},nativeOn:{click:function(o){return e.chooseSender(t)}}})})),1)],1),o("el-form-item",{attrs:{label:"私钥"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.form.private_key,callback:function(t){e.$set(e.form,"private_key",t)},expression:"form.private_key"}})],1),o("el-form-item",{attrs:{label:"公钥"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.form.public_key,callback:function(t){e.$set(e.form,"public_key",t)},expression:"form.public_key"}})],1),o("el-form-item",{attrs:{label:"转账金额",prop:"value"}},[o("el-input",{attrs:{maxlength:"10"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",e._n(t))},expression:"form.value"}})],1),o("el-form-item",{attrs:{label:"合约名称"}},[o("el-select",{staticStyle:{width:"100%"},model:{value:e.form.contract,callback:function(t){e.$set(e.form,"contract",t)},expression:"form.contract"}},e._l(e.contractList,(function(t){return o("el-option",{key:t.data.contractname,attrs:{label:t.data.contractname+" ( "+t.address+" )",value:t.data.contractname},nativeOn:{click:function(o){return e.chooseContract(t)}}})})),1)],1),e.codeVisible?o("codemirror",{attrs:{options:e.cmOption},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}):e._e(),e.codeVisible?o("el-form-item"):e._e(),o("el-form-item",{attrs:{label:"方法"}},[o("el-select",{staticStyle:{width:"100%"},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}},e._l(e.methodList,(function(t){return o("el-option",{key:t,attrs:{label:t,value:t},nativeOn:{click:function(o){return e.chooseMethod(t)}}})})),1)],1),o("el-form-item",{attrs:{label:"参数"}},[o("el-input",{model:{value:e.form.args,callback:function(t){e.$set(e.form,"args",t)},expression:"form.args"}})],1)],1),o("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.invokeContract}},[e._v("调用合约")])],1)],1)],1)},n=[],s=o("a78e"),a=o.n(s),i=o("619d"),c={data:function(){return{q:{type:"getAllAccounts",parameters:[]},contractList:[],methodList:[],userList:[],form:{private_key:"",public_key:"",from:"",to:"",contract:"",value:0,method:"",dest:"",args:"{}",type:3},disable:!1,rules:{value:[{validator:this.validateValue,trigger:"blur"}]},cmOption:{tabSize:4,lineNumbers:!0,line:!0,mode:"text/x-go",matchBrackets:!0,theme:"monokai",readOnly:!0},code:"",codeVisible:!1}},created:function(){this.getAllAccounts()},methods:{validateValue:function(e,t,o){var r=/^\d+$/g;r.test(t)?(this.disable=!1,o()):(this.disable=!0,o(new Error("金额需为正整数")))},invokeContract:function(){var e=this;this.initWebSocket(),this.disable=!0,setTimeout((function(){e.disable=!1}),1e3),Object(i["c"])(this.form).then((function(t){""===t.error?e.$message({message:"成功提交",type:"success"}):e.$message({message:t.error,type:"warning"})}))},getAllAccounts:function(){var e=this;Object(i["d"])(this.q).then((function(t){var o=[],r=[],n=t.data;n.forEach((function(e){e.iscontract?r.push(e):o.push(e)})),e.contractList=r,e.userList=o,0===o.length?(e.form.account="",e.form.private_key="",e.form.public_key="",a.a.set("PublicKey",""),a.a.set("PrivateKey",""),a.a.set("AccountAddress","")):(e.form.from=a.a.get("AccountAddress"),e.form.private_key=a.a.get("PrivateKey"),e.form.public_key=a.a.get("PublicKey"))}))},chooseContract:function(e){this.form.contract=e.data.contractname,this.code=e.data.code,this.codeVisible=!0,this.form.to=e.address,this.methodList=[];for(var t=e.data.methods,o=0;o<t.length;o++)t[o][0]<="Z"&&t[o][0]>="A"&&this.methodList.push(t[o]);this.methodList.length>0&&(this.form.method=this.methodList[0])},chooseMethod:function(e){this.form.method=e},chooseSender:function(e){this.form.from=e.address,this.form.public_key=e.publickey,this.form.private_key=e.privatekey,a.a.set("AccountAddress",e.address),a.a.set("PublicKey",e.publickey),a.a.set("PrivateKey",e.privatekey)},initWebSocket:function(){if("undefined"===typeof WebSocket)this.$notify({title:"提示",message:"当前浏览器无法接收实时报警信息，请使用谷歌浏览器！",type:"warning",duration:0});else{var e,t=a.a.get("SourceChain");"ssbc1"===t?e="ws://localhost:8009/getLog":"ssbc2"===t&&(e="ws://localhost:8011/getLog"),this.websock=new WebSocket(e),this.websock.onopen=this.onopen,this.websock.onerror=this.onerror,this.websock.onmessage=this.onmessage,this.websock.onclose=this.onclose}},onopen:function(){console.log("socket连接成功")},onerror:function(){console.log("连接错误"),this.initWebSocket()},onmessage:function(e){console.log(e.data),this.$notify({title:"Info",message:e.data})},onclose:function(e){console.log("WebSocket 断开连接",e)}}},l=c,u=o("2877"),d=Object(u["a"])(l,r,n,!1,null,null,null);t["default"]=d.exports}}]);