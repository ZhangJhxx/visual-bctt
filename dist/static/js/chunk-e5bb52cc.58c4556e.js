(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e5bb52cc"],{"296d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-row",{attrs:{gutter:1}},[n("el-col",{attrs:{span:22,offset:1}},[n("el-alert",{attrs:{title:"智能合约编辑与上传",type:"info",description:"请使用Go语言编写","show-icon":""}})],1)],1),n("br"),n("el-row",{attrs:{gutter:0}},[n("el-col",{attrs:{span:22,offset:1,xs:24}},[n("el-form",{attrs:{"label-width":"auto"}},[n("el-form-item",{attrs:{label:e.$t("contractRelease.originatingAddress")}},[n("el-select",{staticClass:"filter-item",staticStyle:{width:"100%"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}},e._l(e.userList,(function(t){return n("el-option",{key:t.address,attrs:{label:t.address,value:t.address},nativeOn:{click:function(n){return e.chooseSender(t)}}})})),1)],1),n("el-form-item",{attrs:{label:e.$t("contractRelease.privateKey")}},[n("el-input",{attrs:{disabled:!0},model:{value:e.form.private_key,callback:function(t){e.$set(e.form,"private_key",t)},expression:"form.private_key"}})],1),n("el-form-item",{attrs:{label:e.$t("contractRelease.publicKey")}},[n("el-input",{attrs:{disabled:!0},model:{value:e.form.public_key,callback:function(t){e.$set(e.form,"public_key",t)},expression:"form.public_key"}})],1),n("el-form-item",{attrs:{label:e.$t("contractRelease.contractName")}},[n("el-input",{attrs:{oninput:"this.value=this.value.replace(/[^[a-z0-9A-Z]/g,'')"},on:{input:e.lengthRestriction},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:e.$t("contractRelease.contractGeneration")}},[n("el-collapse",{attrs:{accordion:""}},[n("el-collapse-item",[n("template",{slot:"title"},[e._v(e._s(e.$t("contractRelease.contractGenerationInfo")))]),n("el-form-item",{attrs:{label:e.$t("contractRelease.ontologyModel")}},[n("el-upload",{staticClass:"upload",attrs:{name:"ontology",action:"http://localhost:8011/modelUpload",accept:".owl",limit:1,"on-exeed":e.handleExceed,"file-list":e.fileList}},[n("el-button",{attrs:{type:"primary",size:"small"}},[e._v(e._s(e.$t("contractRelease.upload")))])],1)],1),n("el-form-item",{attrs:{label:e.$t("contractRelease.bpmnModel")}},[n("el-upload",{attrs:{name:"bpmn",action:"http://127.0.0.1:8011/modelUpload",accept:".xml",limit:1,"on-exeed":e.handleExceed,"file-list":e.fileList}},[n("el-button",{attrs:{type:"primary",size:"small"}},[e._v("点击上传")])],1)],1),n("el-form-item",{attrs:{label:" "}},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.codeGen}},[e._v("生成代码")])],1)],2)],1)],1),n("codemirror",{attrs:{options:e.cmOption},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}}),n("el-form-item"),n("el-button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.postContract}},[e._v("创建合约")])],1)],1)],1),n("el-dialog",{attrs:{title:"错误信息",visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("span",{staticStyle:{"white-space":"pre-wrap"},domProps:{innerHTML:e._s(this.errMsg)}},[e._v(e._s(e.errMsg))]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},o=[],a=n("a7ef"),i=n.n(a),s=n("8f94"),c=(n("4ff4"),n("1386")),l=n.n(c),u=(n("7a7a"),n("a78e")),d=n.n(u),m=n("619d"),f={components:{codemirror:s["codemirror"]},data:function(){return{errMsg:"",dialogVisible:!1,q:{type:"getAllAccounts",parameters:[]},userList:[],form:{account:"",private_key:"",public_key:"",name:"",type:2,code:i()('package main\n\nvar A int\nvar B string\nvar invisible string\n\nfunc init() {\n\tA = 0\n\tB = "init"\n\tinvisible = "init"\n}\n\nfunc Add(args map[string]interface{}) (interface{}, error) {\n\tA += 1\n\tB = "Add"\n\tinvisible = "Add"\n\treturn nil, nil\n}\n\nfunc Subtract(args map[string]interface{}) (interface{}, error) {\n\tA -= 1\n\tB = "Subtract"\n\tinvisible = "Subtract"\n\treturn nil, nil\n}')},user:{},cmOption:{tabSize:4,lineNumbers:!0,line:!0,mode:"text/x-go",matchBrackets:!0,theme:"monokai"},disable:!1,fileList:[]}},created:function(){this.getAllAccounts()},methods:{postContract:function(){var e=this;this.disable=!0,setTimeout((function(){e.disable=!1}),4e3),Object(m["b"])(this.form).then((function(t){if(""===t.error)e.$message({message:"成功提交",type:"success"});else{var n=t.error.replace(/\n/g,"\r\n"),r=new l.a;e.errMsg=r.ansi_to_html(n),console.log(e.errMsg),e.dialogVisible=!0}}))},getAllAccounts:function(){var e=this;Object(m["d"])(this.q).then((function(t){var n=[],r=[],o=t.data;o.forEach((function(e){e.iscontract?r.push(e):n.push(e)})),e.userList=n,0===n.length?(e.form.account="",e.form.private_key="",e.form.public_key="",d.a.set("PublicKey",""),d.a.set("PrivateKey",""),d.a.set("AccountAddress","")):(e.form.account=d.a.get("AccountAddress"),e.form.private_key=d.a.get("PrivateKey"),e.form.public_key=d.a.get("PublicKey"))}))},chooseSender:function(e){this.form.from=e.address,this.form.public_key=e.publickey,this.form.private_key=e.privatekey,d.a.set("AccountAddress",e.address),d.a.set("PublicKey",e.publickey),d.a.set("PrivateKey",e.privatekey)},lengthRestriction:function(){this.form.name.length>64&&(this.form.name=this.form.name.slice(0,64))},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},codeGen:function(){var e=this;Object(m["a"])().then((function(t){console.log(t),e.form.code=i()(t.data)})),console.log("执行codeGen")}}},p=f,b=n("2877"),g=Object(b["a"])(p,r,o,!1,null,null,null);t["default"]=g.exports},"619d":function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return g}));var r=n("bc3a"),o=n.n(r),a=n("5c96"),i=n("4360"),s=n("5f87"),c=n("a78e"),l=n.n(c),u=o.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"/visual-bctt/"}).VUE_APP_SSBC1_API,timeout:5e3});u.interceptors.request.use((function(e){return i["a"].getters.token&&(e.headers["X-Token"]=Object(s["a"])(),e.baseURL=l.a.get("SourceChain")),e}),(function(e){return console.log(e),Promise.reject(e)})),u.interceptors.response.use((function(e){var t=e.data;return 2e4!==t.code?(Object(a["Message"])({message:t.message||"Error",type:"error",duration:5e3}),50008!==t.code&&50012!==t.code&&50014!==t.code||a["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){i["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):t}),(function(e){return console.log("err"+e),Object(a["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}));var d=u;function m(e){return d({url:"/postTran",method:"post",data:e})}function f(){return d({url:"/registerAccount",method:"get"})}function p(e){return d({url:"/postContract",method:"post",data:e})}function b(e){return d({url:"/query",method:"post",data:e})}function g(){return d({url:"/genCode",method:"get"})}}}]);